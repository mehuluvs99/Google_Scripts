<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Quotation Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      background-color: #010647;
    }

    .container {
      background-color: #FFF5DF;
      padding: 5px;
      border-radius: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
      /* background-color:"lightblue"; */
    }

    h1 {
      text-align: center;
      margin-bottom: 5px;
      font-size:30px;
    }

    .form-label {
      font-weight: bold;
    }

    .form-control form-control-sm {
      margin-bottom: 10px;
    }

    .btn-primary {
      width: 100%;
    }

    .progress {
      margin-top: 20px;
    }

    .progress-bar {
      transition: width 0.3s ease-in-out;
      min-width: 10%;
      font-weight: bold;
    }
    
  </style>
</head>


<body>
  <div class="container">
    <h1>Quotation Form</h1>
    <form id="data-form">
      <div class="mb-4 row">
          <div class="col-sm-2">
            <select required class="form-control form-control-sm" id="companyselectInput">
              <option selected>Select Company</option>
              <option value="1">CAN ENDS GROUP</option>
              <option value="2">LAMY INTERNATIONAL</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Timestamp" id="timestampInput" disabled>
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Quotation No" id="quotationInput" disabled>
          </div>
          <div class="col-sm-2">
            <input type="text" required class="form-control form-control-sm" placeholder="Enquiry No" id="enquirynoInput">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Refrence" id="refrenceInput" disabled>
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Prepared By" id="preparedbyInput" disabled>
          </div>
      </div>
      <div class="mb-4 row">
        <label for="companynameInput" class="col-sm-2 col-form-label">Company Name:</label>
          <div class="col-sm-10">
            <input type="text" required class="form-control form-control-sm" id="companynameInput">
          </div>
        <label for="companyaddressInput" class="col-sm-2 col-form-label">Company Address:</label>
          <div class="col-sm-10">
            <textarea required class="form-control form-control-sm" id="companyaddressInput" rows="1"></textarea>
          </div>
        <label for="personnamenoInput" class="col-sm-2 col-form-label">Contact Name:</label>
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" id="personnamenoInput">
          </div>
        <!-- <label for="personemailidInput" class="col-sm-2 col-form-label">Person Email ID:</label> -->
          <div class="col-sm-4">
            <input type="email" class="form-control form-control-sm" placeholder="Email ID" id="personemailidInput">
          </div>
        <!-- <label for="contactnoInput" class="col-sm-2 col-form-label">Contact No:</label> -->
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Contact No" id="contactnoInput">
          </div>
      </div>
      <div class="mb-4 row">
        <label for="itemcategory1Input" class="col-sm-2 col-form-label">Item Category 1:</label>
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" id="itemcategory1Input">
          </div>
        <label for="itemcategory2Input" class="col-sm-2 col-form-label">Item Category 2:</label>
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" id="itemcategory2Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" placeholder="Item Name" id="itemname1Input">
          </div>
          <div class="col-sm-2">
            <input type="text" required class="form-control form-control-sm" placeholder="Design" id="design1Input">
          </div>
          <div class="col-sm-1">
            <select required class="form-control form-control-sm" id="unit1Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" required class="form-control form-control-sm" placeholder="Item Qty" id="itemqty1Input">
          </div>
          <div class="col-sm-1">
            <select required class="form-control form-control-sm" id="currency1Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" required class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs1Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname2Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design2Input">
          </div>
          <div class="col-sm-1">
            <select required class="form-control form-control-sm" id="unit2Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty2Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency2Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs2Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname3Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design3Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="unit3Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty3Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency3Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs3Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname4Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design4Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="unit4Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
            
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty4Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency4Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs4Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname5Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design5Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="unit5Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty5Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency5Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs5Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname6Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design6Input">
          </div>
          <div class="col-sm-1">
            <select required class="form-control form-control-sm" id="unit6Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty6Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency6Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs6Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname7Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design7Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="unit7Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty7Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency7Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs7Input">
          </div>
      </div>
      <div class="mb-4 row">
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" placeholder="Item Name" id="itemname8Input">
          </div>
          <div class="col-sm-2">
            <input type="text" class="form-control form-control-sm" placeholder="Design" id="design/Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="unit8Input">
              <option selected>Unit</option>
              <option value="1">MT</option>
              <option value="2">PCS</option>
              <option value="3">Sheet</option>
            </select>
            
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Item Qty" id="itemqty8Input">
          </div>
          <div class="col-sm-1">
            <select class="form-control form-control-sm" id="currency8Input">
              <option selected>Currency</option>
              <option value="1">USD</option>
              <option value="2">AED</option>
              <option value="3">EURO</option>
            </select>
          </div>
          <div class="col-sm-2">
            <input type="number" class="form-control form-control-sm" placeholder="Rate per/1000 Pcs" id="rateperpcs8Input">
          </div>
      </div>
      <div class="mb-4 row">
          <label for="noteInput" class="col-sm-2 col-form-label">Note:</label>
          <div class="col-sm-10">
            <!-- <input type="text" class="form-control form-control-sm" id="companyaddressInput"> -->
            <textarea class="form-control form-control-sm" id="noteInput" rows="1"></textarea>
          </div>
      </div>
      
      <div class="mb-4 row">
        <label for="incotermInput" class="col-sm-2 col-form-label">Inco Term:</label>
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" id="incotermInput">
          </div>
        <label for="countryoforiginInput" class="col-sm-2 col-form-label">Country of Origin:</label>
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" id="countryoforiginInput">
          </div>
        <label for="paymenttermsInput" class="col-sm-2 col-form-label">Payment Terms:</label>
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" id="paymenttermsInput">
          </div>
        <label for="validityInput" class="col-sm-2 col-form-label">Validity:</label>
          <div class="col-sm-2">
            <input type="date" required class="form-control form-control-sm" placeholder="validity" id="validityInput">
          </div>
        <!-- <label for="leadtimeInput" class="col-sm-2 col-form-label">Lead Time:</label> -->
          <div class="col-sm-2">
            <input type="number" required class="form-control form-control-sm" placeholder="Lead Time" id="leadtimeInput">
          </div>
        <label for="destinationInput" class="col-sm-2 col-form-label">Destination:</label>
          <div class="col-sm-4">
            <input type="text" required class="form-control form-control-sm" id="destinationInput">
          </div>
        <label for="emailidInput" class="col-sm-2 col-form-label">Email ID:</label>
          <div class="col-sm-4">
            <input type="text" class="form-control form-control-sm" id="emailidInput" disabled>
          </div>
      </div>
      <button type="button" class="btn btn-primary" id='submit-button' >Submit</button>
      <div class="progress" style="height: 25px;">
        <div class="progress-bar" id='progressBarContainer' style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="0">0%</div>
      </div>
    </form>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    function setInitialValues() {
      google.script.run.withSuccessHandler(updatetimestamp).timestamps();      
      google.script.run.withSuccessHandler(updateActiveUser).getActiveUser();
      google.script.run.withSuccessHandler(updatepreparedby).getpreparedby();
    }

    function updatetimestamp(timestamps){
      $('#timestampInput').val(timestamps);
    }

    function updatequotationNo(qoutation) {
      $('#quotationInput').val(qoutation);
    }

    function updateActiveUser(activeUser) {
      $('#emailidInput').val(activeUser);
    }
    
    function updatepreparedby(preparedby) {
      $('#preparedbyInput').val(preparedby);
    }

    $(document).ready(function() {
      setInitialValues();
    });

    $(document).ready(function() {
      $('#companyselectInput').on('change', function() {
        // Get the selected company value from the dropdown
        var selectedCompany = $(this).val();
        console.log(selectedCompany);
        
        // Call the server-side function to get the updated quotation
        google.script.run.withSuccessHandler(updatequotationNo).getUpdatedQuotation(selectedCompany);
      });
    });

  
  $(document).ready(function() {
    var bar = $(".progress-bar");

    function makeProgress(i) {
      if (i < 100) {
        console.log("Progress : ", i);
        bar.css("width", i + "%");
        bar.text(i + "%");
        i = i + 9;
        setTimeout(function () {
          makeProgress(i);
        }, 100);
      }
    }

    function resetProgressBar() {
      bar.css("width", "0%");
      bar.text("0%");
    }

    
    $("#submit-button").on("click", function() {
      var i = 0;
      var selectcompany = $("#companyselectInput").val()
      var timestamp = $("#timestampInput").val();
      var quotationno = $("#quotationInput").val();
      var enquiry_no = $("#enquirynoInput").val();
      var refrence = $("#refrenceInput").val();
      var company_name = $("#companynameInput").val();
      var company_address = $('#companyaddressInput').val();
      var contactname = $('#personnamenoInput').val();
      var contactmailid = $("#personemailidInput").val();
      var contactno = $("#contactnoInput").val();
      var itemcat1 = $("#itemcategory1Input").val();
      var itemcat2 = $("#itemcategory2Input").val();
      var itemname1 = $("#itemname1Input").val();
      var design1 = $("#design1Input").val();
      var unit1 = $("#unit1Input").val();
      var itemqty1 = $("#itemqty1Input").val();
      var currency1 = $("#currency1Input").val();
      var rateper1 = $("#rateperpcs1Input").val();
      var itemname2 = $("#itemname2Input").val();
      var design2 = $("#design2Input").val();
      var unit2 = $("#unit2Input").val();
      var itemqty2 = $("#itemqty2Input").val();
      var currency2 = $("#currency2Input").val();
      var rateper2 = $("#rateperpcs2Input").val();
      var itemname3 = $("#itemname3Input").val();
      var design3 = $("#design3Input").val();
      var unit3 = $("#unit3Input").val();
      var itemqty3 = $("#itemqty3Input").val();
      var currency3 = $("#currency3Input").val();
      var rateper3 = $("#rateperpcs3Input").val();
      var itemname4 = $("#itemname4Input").val();
      var design4 = $("#design4Input").val();
      var unit4 = $("#unit4Input").val();
      var itemqty4 = $("#itemqty4Input").val();
      var currency4 = $("#currency4Input").val();
      var rateper4 = $("#rateperpcs4Input").val();


      var note = $("#noteInput").val();
      var incoterm = $("#incotermInput").val();
      var countryodorigin = $("#countryoforiginInput").val();
      var paymentterm = $("#paymenttermsInput").val();
      var validity = $("#validityInput").val();
      var leadtime = $("#leadtimeInput").val();
      var destination = $("#destinationInput").val();
      var crmmailid = $("#emailidInput").val();


      var formData = [selectcompany,timestamp, quotationno, enquiry_no, refrence, company_name, company_address, contactname, contactno, itemcat1, itemcat2, itemname1, design1, unit1,itemqty1,currency1,rateper1,itemname2, design2, unit2,itemqty2,currency2,rateper2,itemname3, design3, unit3,itemqty3,currency3,rateper3,itemname4, design4, unit4,itemqty4,currency4,rateper4, note, incoterm, countryodorigin, paymentterm, validity, leadtime, destination, crmmailid];

      makeProgress(i);
      google.script.run
      .withSuccessHandler(function() {
        alert('Data submitted successfully.');
        $("#data-form")[0].reset();
        resetProgressBar();
        setInitialValues();

      }).submitForm(formData);
    });
  });
  </script>
  
  <script> src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"</script>
</body>
</html>
